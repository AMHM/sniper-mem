ARCH_QUERY=$(shell uname -m)
ifeq ($(ARCH_QUERY),i686)
TARGET_ARCH = ia32
else
ifeq ($(ARCH_QUERY),x86_64)
TARGET_ARCH ?= intel64
#TARGET_ARCH = ia32
else
$(error Unknown target arch: $(ARCH_QUERY))
endif
endif


# where Pin is unzipped to
PIN_HOME ?= $(SIM_ROOT)/pin_kit


OS_TYPE ?= $(shell $(SIM_ROOT)/tools/get_os_type.sh)

ifeq ($(OS_TYPE),Ubuntu)
  CC?=gcc
  CXX?=g++
else
ifeq ($(OS_TYPE),ScientificLinux)
  # Fix a bug in old make versions where ?= does not override default variables
  ifeq ($(origin CC),default)
    CC=gcc44
  endif
  ifeq ($(origin CXX),default)
    CXX=g++44
  endif
  BOOST_INCLUDE=$(SIM_ROOT)/boost_1_38_0/include
else
ifeq ($(OS_TYPE),Debian)
  CC?=gcc
  CXX?=g++
endif
endif
endif


ifneq ($(DEBUG_SHOW_COMPILE),)
  SHOW_COMPILE=1
  MAKE_QUIET=
else
  SHOW_COMPILE=
  MAKE_QUIET=--quiet
endif

ifneq ($(DEBUG),)
  OPT_CFLAGS = -O0 -g
else
  OPT_CFLAGS = -O2 -g
endif
